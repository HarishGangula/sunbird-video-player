!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@project-sunbird/client-services/telemetry"),require("@project-sunbird/sunbird-player-sdk-v8"),require("rxjs"),require("@angular/common/http"),require("@angular/common"),require("@angular/forms")):"function"==typeof define&&define.amd?define("@project-sunbird/sunbird-video-player-v8",["exports","@angular/core","@project-sunbird/client-services/telemetry","@project-sunbird/sunbird-player-sdk-v8","rxjs","@angular/common/http","@angular/common","@angular/forms"],t):t(((e=e||self)["project-sunbird"]=e["project-sunbird"]||{},e["project-sunbird"]["sunbird-video-player-v8"]={}),e.ng.core,e.telemetry,e.sunbirdPlayerSdkV8,e.rxjs,e.ng.common.http,e.ng.common,e.ng.forms)}(this,(function(e,t,r,i,n,a,o,s){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var l=function(){return(l=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function p(e,t,r,i){return new(r||(r=Promise))((function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))}function c(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var d=function(){function e(){}return e.prototype.uniqueId=function(e){void 0===e&&(e=32);for(var t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=r.length,n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*i));return t},e.prototype.getTimeSpentText=function(e){var t=Math.floor(e/6e4),r=Number((e%6e4/1e3).toFixed(0));return t+":"+(r<10?"0":"")+r},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),u=function(){function e(e){this.utilService=e,this.contentSessionId=this.utilService.uniqueId()}return e.prototype.initialize=function(e){var t=e.context,i=e.config,n=e.metadata;this.context=t,this.config=i,this.playSessionId=this.utilService.uniqueId(),r.CsTelemetryModule.instance.isInitialised||(r.CsTelemetryModule.instance.init({}),r.CsTelemetryModule.instance.telemetryService.initTelemetry({config:{pdata:t.pdata,env:"ContentPlayer",channel:t.channel,did:t.did,authtoken:t.authToken||"",uid:t.uid||"",sid:t.sid,batchsize:20,mode:t.mode,host:t.host||"",endpoint:t.endpoint||"/data/v3/telemetry",tags:t.tags,cdata:[{id:this.contentSessionId,type:"ContentSession"},{id:this.playSessionId,type:"PlaySession"}]},userOrgDetails:{}})),this.telemetryObject={id:n.identifier,type:"Content",ver:n.pkgVersion+"",rollup:t.objectRollup||{}}},e.prototype.start=function(e){r.CsTelemetryModule.instance.telemetryService.raiseStartTelemetry({options:this.getEventOptions(),edata:{type:"content",mode:"play",pageid:"",duration:Number((e/1e3).toFixed(2))}})},e.prototype.end=function(e,t,i,n,a,o){var s=Number((e/1e3).toFixed(2));r.CsTelemetryModule.instance.telemetryService.raiseEndTelemetry({edata:{type:"content",mode:"play",pageid:"sunbird-player-Endpage",summary:[{progress:Number((i/t*100).toFixed(0))},{totallength:t},{visitedlength:o},{visitedcontentend:t===i},{totalseekedlength:a},{endpageseen:n}],duration:s},options:this.getEventOptions()})},e.prototype.interact=function(e,t){r.CsTelemetryModule.instance.telemetryService.raiseInteractTelemetry({options:this.getEventOptions(),edata:{type:"TOUCH",subtype:"",id:e,pageid:t+""}})},e.prototype.heartBeat=function(e){r.CsTelemetryModule.instance.playerTelemetryService.onHeartBeatEvent(e,{})},e.prototype.impression=function(e){r.CsTelemetryModule.instance.telemetryService.raiseImpressionTelemetry({options:this.getEventOptions(),edata:{type:"workflow",subtype:"",pageid:e+"",uri:""}})},e.prototype.error=function(e,t,i){r.CsTelemetryModule.instance.telemetryService.raiseErrorTelemetry({options:this.getEventOptions(),edata:{err:e,errtype:t,stacktrace:i&&i.toString()||""}})},e.prototype.getEventOptions=function(){return{object:this.telemetryObject,context:{channel:this.context.channel,pdata:this.context.pdata,env:"ContentPlayer",sid:this.context.sid,uid:this.context.uid,cdata:[{id:this.contentSessionId,type:"ContentSession"},{id:this.playSessionId,type:"PlaySession"}],rollup:this.context.contextRollup||{}}}},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:d}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(d))},token:e,providedIn:"root"}),e}();var h=function(){function e(e,r,i){this.videoPlayerService=e,this.utilService=r,this.http=i,this.endPageSeen=!1,this.timeSpent="0:0",this.version="1.0",this.playerEvent=new t.EventEmitter,this.sidebarMenuEvent=new t.EventEmitter,this.isAvailableLocally=!1,this.PlayerLoadStartedAt=(new Date).getTime()}return e.prototype.initialize=function(e){var t=e.context,r=e.config,i=e.metadata;if(this.contentName=i.name,this.streamingUrl=i.streamingUrl,this.artifactUrl=i.artifactUrl,this.mimeType=i.streamingUrl?"application/x-mpegURL":i.mimeType,this.artifactMimeType=i.mimeType,this.isAvailableLocally=i.isAvailableLocally,this.traceId=r.traceId,this.markers=r.markers,t.userData){var n=t.userData,a=n.firstName,o=n.lastName;this.userName=a===o?a:a+" "+o}this.metaData={actions:[],volume:[],playBackSpeeds:[],totalDuration:0},this.showDownloadPopup=!1,this.endPageSeen=!1},e.prototype.getPlayerOptions=function(){return p(this,void 0,void 0,(function(){var e=this;return c(this,(function(t){switch(t.label){case 0:return this.streamingUrl?[3,1]:[2,[{src:this.artifactUrl,type:this.artifactMimeType}]];case 1:return[4,this.http.head(this.streamingUrl,{responseType:"blob"}).toPromise().catch((function(t){e.raiseExceptionLog(i.errorCode.streamingUrlSupport,i.errorMessage.streamingUrlSupport,new Error("Streaming Url Not Supported  "+e.streamingUrl),e.traceId)}))];case 2:return t.sent()?[2,[{src:this.streamingUrl,type:this.mimeType}]]:[2,[{src:this.artifactUrl,type:this.artifactMimeType}]];case 3:return[2]}}))}))},e.prototype.getMarkers=function(){return this.markers},e.prototype.pageSessionUpdate=function(){},e.prototype.raiseStartEvent=function(e){var t=(new Date).getTime()-this.PlayerLoadStartedAt,r={eid:"START",ver:this.version,edata:{type:"START",mode:"play",duration:t},metaData:this.metaData};this.playerEvent.emit(r),this.videoPlayerService.start(t),this.PlayerLoadStartedAt=(new Date).getTime()},e.prototype.raiseEndEvent=function(){var e=(new Date).getTime()-this.PlayerLoadStartedAt,t={eid:"END",ver:this.version,edata:{type:"END",currentTime:this.currentlength,totalTime:this.totalLength,duration:e},metaData:this.metaData};this.playerEvent.emit(t),this.timeSpent=this.utilService.getTimeSpentText(this.visitedLength),this.videoPlayerService.end(e,this.totalLength,this.currentlength,this.endPageSeen,this.totalSeekedLength,this.visitedLength/1e3)},e.prototype.raiseHeartBeatEvent=function(e){var t={eid:"HEARTBEAT",ver:this.version,edata:{type:e,currentPage:"videostage"},metaData:this.metaData};this.playerEvent.emit(t),this.videoPlayerService.heartBeat(t);["PLAY","PAUSE","EXIT","VOLUME_CHANGE","DRAG","RATE_CHANGE","CLOSE_DOWNLOAD","DOWNLOAD","NAVIGATE_TO_PAGE","NEXT","OPEN_MENU","PREVIOUS","CLOSE_MENU","DOWNLOAD_MENU","SHARE","REPLAY","FORWARD","BACKWARD","FULLSCREEN","NEXT_CONTENT_PLAY"].includes(e)&&this.videoPlayerService.interact(e.toLowerCase(),"videostage")},e.prototype.raiseExceptionLog=function(e,t,r,i){var n={eid:"ERROR",edata:{err:e,errtype:t,requestid:i||"",stacktrace:r&&r.toString()||""}};this.playerEvent.emit(n),this.videoPlayerService.error(e,t,r)},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:u},{type:d},{type:a.HttpClient}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(u),t.ɵɵinject(d),t.ɵɵinject(a.HttpClient))},token:e,providedIn:"root"}),e}();var y=function(){function e(e,r,n,a,o){var s=this;this.videoPlayerService=e,this.viewerService=r,this.cdr=n,this.renderer2=a,this.errorService=o,this.telemetryEvent=new t.EventEmitter,this.viewState="player",this.showControls=!0,this.sideMenuConfig={showShare:!0,showDownload:!0,showReplay:!0,showExit:!0},this.isPaused=!1,this.playerEvent=this.viewerService.playerEvent,this.viewerService.playerEvent.subscribe((function(e){if("pause"===e.type&&(s.isPaused=!0,s.showControls=!0),"play"===e.type&&(s.isPaused=!1),"loadstart"===e.type&&s.viewerService.raiseStartEvent(e),"ended"===e.type&&(s.viewerService.endPageSeen=!0,s.viewerService.raiseEndEvent(),s.viewState="end"),"error"===e.type){var t=i.errorCode.contentLoadFails,r=i.errorMessage.contentLoadFails;navigator.onLine||(t=i.errorCode.internetConnectivity,r=i.errorMessage.internetConnectivity),s.viewerService.isAvailableLocally&&(t=i.errorCode.contentLoadFails,r=i.errorMessage.contentLoadFails),t===i.errorCode.contentLoadFails&&(s.showContentError=!0),s.viewerService.raiseExceptionLog(t,r,e,s.traceId)}[{type:"volumechange",telemetryEvent:"VOLUME_CHANGE"},{type:"seeking",telemetryEvent:"DRAG"},{type:"fullscreen",telemetryEvent:"FULLSCREEN"},{type:"ratechange",telemetryEvent:"RATE_CHANGE"}].forEach((function(t){e.type===t.type&&s.viewerService.raiseHeartBeatEvent(t.telemetryEvent)}))}))}return e.prototype.onTelemetryEvent=function(e){this.telemetryEvent.emit(e.detail)},e.prototype.ngOnInit=function(){var e=this;setInterval((function(){e.isPaused||(e.showControls=!1)}),5e3),this.nextContent=this.playerConfig.config.nextContent,this.traceId=this.playerConfig.config.traceId,this.sideMenuConfig=l({},this.sideMenuConfig,this.playerConfig.config.sideMenu),this.viewerService.initialize(this.playerConfig),this.videoPlayerService.initialize(this.playerConfig)},e.prototype.sidebarMenuEvent=function(e){this.viewerService.sidebarMenuEvent.emit(e)},e.prototype.ngAfterViewInit=function(){var e=this,t=this.videoPlayerRef.nativeElement;this.unlistenMouseMove=this.renderer2.listen(t,"mousemove",(function(){e.showControls=!0})),this.unlistenTouchStart=this.renderer2.listen(t,"touchstart",(function(){e.showControls=!0}));var r=this.playerConfig.metadata.compatibilityLevel;if(r){var n=this.errorService.checkContentCompatibility(r);n.isCompitable||this.viewerService.raiseExceptionLog(i.errorCode.contentCompatibility,i.errorMessage.contentCompatibility,n.error.message,this.traceId)}},e.prototype.sideBarEvents=function(e){var t=this;this.playerEvent.emit(e),"DOWNLOAD"===e&&this.downloadVideo();["SHARE","DOWNLOAD_MENU","EXIT","CLOSE_MENU"].forEach((function(r){e===r&&t.viewerService.raiseHeartBeatEvent(r),"EXIT"===e&&t.viewerService.sidebarMenuEvent.emit("CLOSE_MENU")}))},e.prototype.playContent=function(e){this.viewerService.raiseHeartBeatEvent(e.type)},e.prototype.replayContent=function(e){this.playerEvent.emit(e),this.viewState="player",this.viewerService.raiseHeartBeatEvent("REPLAY")},e.prototype.exitContent=function(e){this.playerEvent.emit(e),this.viewerService.raiseHeartBeatEvent("EXIT")},e.prototype.downloadVideo=function(){var e=document.createElement("a");e.href=this.viewerService.artifactUrl,e.download=this.viewerService.contentName,e.target="_blank",document.body.appendChild(e),e.click(),e.remove(),this.viewerService.raiseHeartBeatEvent("DOWNLOAD")},e.prototype.ngOnDestroy=function(){this.viewerService.raiseEndEvent(),this.unlistenTouchStart(),this.unlistenMouseMove()},e.decorators=[{type:t.Component,args:[{selector:"sunbird-video-player",template:'<div class="sunbird-video-player-container" #videoPlayer>\n      <sb-player-side-menu-icon class="sb-player-side-menu-icon notVisible" (sidebarMenuEvent)="viewerService.raiseHeartBeatEvent($event); sidebarMenuEvent($event);"\n            *ngIf="viewState ===\'player\'" [ngClass]="{\'isVisible\': showControls}"></sb-player-side-menu-icon>\n      <video-player *ngIf="viewState === \'player\'" [events]="events">\n      </video-player>\n      <sb-player-sidebar *ngIf="viewState ===\'player\'"\n       [title]="viewerService.contentName"\n      (sidebarEvent)="sideBarEvents($event)" [config]="sideMenuConfig"></sb-player-sidebar>\n      <sb-player-end-page [contentName]="viewerService.contentName" [nextContent]="nextContent" [userName]="viewerService.userName" [showExit]="sideMenuConfig.showExit"\n            [timeSpentLabel]="viewerService.timeSpent" (playNextContent)="playContent($event)" (exitContent)="exitContent($event)"   (replayContent)="replayContent($event)"\n            *ngIf="viewState === \'end\'"></sb-player-end-page>\n      <sb-player-contenterror *ngIf="showContentError"></sb-player-contenterror>\n</div>',styles:[".sunbird-video-player-container{width:100%;height:100%;overflow:hidden;position:relative}pdf-menu{position:absolute;top:0;left:0;z-index:99}.BtmNotVisible,.notVisible{-webkit-transition:1s ease-in-out;transition:1s ease-in-out;position:absolute;width:100%}.notVisible{top:-10rem}.notVisible.isVisible{top:0}.BtmNotVisible{bottom:-10rem}.BtmNotVisible.isVisible{bottom:0}::ng-deep .sunbird-video-player-container .sb-player-side-menu-icon input[type=checkbox]:checked~#overlay-button span{background:0 0!important}::ng-deep .sunbird-video-player-container .sb-player-side-menu-icon input[type=checkbox]:checked~#overlay-button span:after,::ng-deep .sunbird-video-player-container .sb-player-side-menu-icon input[type=checkbox]:checked~#overlay-button span:before,::ng-deep .sunbird-video-player-container .sb-player-side-menu-icon input[type=checkbox]:checked~#overlay-button:hover span:after,::ng-deep .sunbird-video-player-container .sb-player-side-menu-icon input[type=checkbox]:checked~#overlay-button:hover span:before{background-color:rgba(255,255,255,.7)!important}::ng-deep .sunbird-video-player-container .sb-player-side-menu-icon label{background:rgba(51,51,51,.5)}::ng-deep .sunbird-video-player-container .sb-player-side-menu-icon label span,::ng-deep .sunbird-video-player-container .sb-player-side-menu-icon label span:after,::ng-deep .sunbird-video-player-container .sb-player-side-menu-icon label span:before{background-color:rgba(255,255,255,.7)!important}::ng-deep .sunbird-pdf-player{overflow:hidden}::ng-deep .pdfViewer .page{background:0 0!important;-webkit-border-image:none!important;-o-border-image:none!important;border-image:none!important;border:0!important}::ng-deep #toolbarContainer{background:0 0!important;height:auto!important}::ng-deep #viewerContainer{position:relative!important;height:calc(100% - 3rem)}::ng-deep .body,::ng-deep .html,::ng-deep .pdf-viewer button,::ng-deep .pdf-viewer input,::ng-deep .pdf-viewer select{font-size:inherit!important}::ng-deep .findbar,::ng-deep .secondaryToolbar,::ng-deep html[dir=ltr] #toolbarContainer,::ng-deep html[dir=rtl] #toolbarContainer{box-shadow:none!important}::ng-deep .zoom{min-height:inherit!important}::ng-deep html[dir=rtl] .sb-pdf-reading-status{left:auto;right:1rem}.sb-pdf-reading-status{color:var(--gray-800);font-size:.75rem;position:absolute;left:1rem;bottom:1rem;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;background:var(--white);border-radius:.5rem;padding:.25em .5rem;z-index:5;line-height:normal}.sb-pdf-reading-status span{background:var(--gray-800);width:.25rem;height:.25rem;display:block;margin:0 .5rem;border-radius:50%}.sbt-pdf-footer{background:var(--white);position:absolute;bottom:0;width:100%;height:3rem;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:end;justify-content:flex-end;padding:.75rem .5rem}@media all and (orientation:landscape){::ng-deep .visible-only-potrait{display:none}}@media all and (orientation:portrait){::ng-deep #viewerContainer{height:calc(100% - 6rem)!important}::ng-deep .visible-only-landscape{display:none}::ng-deep .visible-only-potrait{display:block}::ng-deep .file-download__popup{height:15.125rem}::ng-deep .pdf-endpage{display:block!important;position:relative}::ng-deep .pdf-endpage__left-panel{margin-top:6rem}::ng-deep .pdf-endpage__right-panel .title-section{position:absolute;top:0;left:0;right:0}}@media all and (max-width:640px){.visible-only-landscape{display:none}.visible-only-potrait{display:block}}@media all and (min-width:640px){.visible-only-landscape{display:block}.visible-only-potrait{display:none}}"]}]}],e.ctorParameters=function(){return[{type:u},{type:h},{type:t.ChangeDetectorRef},{type:t.Renderer2},{type:i.ErrorService}]},e.propDecorators={playerConfig:[{type:t.Input}],events:[{type:t.Input}],playerEvent:[{type:t.Output}],telemetryEvent:[{type:t.Output}],videoPlayerRef:[{type:t.ViewChild,args:["videoPlayer",{static:!0}]}],onTelemetryEvent:[{type:t.HostListener,args:["document:TelemetryEvent",["$event"]]}],ngOnDestroy:[{type:t.HostListener,args:["window:beforeunload"]}]},e}();var v=function(){function e(e,t){this.viewerService=e,this.renderer2=t,this.showBackwardButton=!1,this.showForwardButton=!1,this.showPlayButton=!0,this.showPauseButton=!1,this.showControls=!0,this.currentPlayerState="none",this.totalSeekedLength=0,this.previousTime=0,this.currentTime=0,this.seekStart=null,this.time=10,this.totalSpentTime=0,this.isAutoplayPrevented=!1}return e.prototype.ngAfterViewInit=function(){var e=this;this.viewerService.getPlayerOptions().then((function(t){e.player=videojs(e.target.nativeElement,{fluid:!0,sources:t,autoplay:!0,playbackRates:[.5,1,1.5,2],controlBar:{children:["playToggle","volumePanel","durationDisplay","progressControl","remainingTimeDisplay","playbackRateMenuButton","fullscreenToggle"]}},(function(){})),e.player.markers(e.viewerService.getMarkers()),e.registerEvents()})),setInterval((function(){e.isAutoplayPrevented||"pause"===e.currentPlayerState||(e.showControls=!1)}),5e3),this.unlistenTargetMouseMove=this.renderer2.listen(this.target.nativeElement,"mousemove",(function(){e.showControls=!0})),this.unlistenTargetTouchStart=this.renderer2.listen(this.target.nativeElement,"touchstart",(function(){e.showControls=!0})),this.viewerService.sidebarMenuEvent.subscribe((function(t){"OPEN_MENU"===t&&e.pause(),"CLOSE_MENU"===t&&e.play()})),this.eventsSubscription=this.events.subscribe((function(t){var r=t.action;t.data;"play"===r?e.play():"pause"===r&&e.pause()}))},e.prototype.registerEvents=function(){var e=this,t=this.player.play();void 0!==t&&t.catch((function(t){e.isAutoplayPrevented=!0}));this.player.on("fullscreenchange",(function(t){e.player.isFullscreen()&&e.target.nativeElement.parentNode.appendChild(e.controlDiv.nativeElement),e.viewerService.raiseHeartBeatEvent("FULLSCREEN")})),this.player.on("pause",(function(t){e.pause()})),this.player.on("play",(function(t){e.currentPlayerState="play",e.showPauseButton=!0,e.showPlayButton=!1,e.viewerService.raiseHeartBeatEvent("PLAY"),e.isAutoplayPrevented=!1})),this.player.on("timeupdate",(function(t){e.handleVideoControls(t),e.viewerService.playerEvent.emit(t),e.player.currentTime()===e.player.duration()&&(e.handleVideoControls({type:"ended"}),e.viewerService.playerEvent.emit({type:"ended"}))})),["loadstart","play","pause","durationchange","error","playing","progress","seeked","seeking","volumechange","ratechange"].forEach((function(t){e.player.on(t,(function(t){e.handleVideoControls(t),e.viewerService.playerEvent.emit(t)}))}))},e.prototype.toggleForwardRewindButton=function(){this.showForwardButton=!0,this.showBackwardButton=!0,this.player.currentTime()+this.time>this.player.duration()&&(this.showForwardButton=!1),this.player.currentTime()-this.time<0&&(this.showBackwardButton=!1)},e.prototype.play=function(){this.player.play(),this.currentPlayerState="play",this.showPauseButton=!0,this.showPlayButton=!1,this.toggleForwardRewindButton()},e.prototype.pause=function(){this.player.pause(),this.currentPlayerState="pause",this.showPauseButton=!1,this.showPlayButton=!0,this.toggleForwardRewindButton(),this.viewerService.raiseHeartBeatEvent("PAUSE")},e.prototype.backward=function(){this.player.currentTime(this.player.currentTime()-this.time),this.toggleForwardRewindButton(),this.viewerService.raiseHeartBeatEvent("BACKWARD")},e.prototype.forward=function(){this.player.currentTime(this.player.currentTime()+this.time),this.toggleForwardRewindButton(),this.viewerService.raiseHeartBeatEvent("FORWARD")},e.prototype.handleVideoControls=function(e){var t=e.type;"playing"===t&&(this.showPlayButton=!1,this.showPauseButton=!0),"ended"===t&&(this.totalSpentTime+=(new Date).getTime()-this.startTime,this.viewerService.visitedLength=this.totalSpentTime,this.viewerService.currentlength=this.player.currentTime(),this.viewerService.totalLength=this.player.duration(),this.updatePlayerEventsMetadata({type:t})),"pause"===t&&(this.totalSpentTime+=(new Date).getTime()-this.startTime,this.updatePlayerEventsMetadata({type:t})),"play"===t&&(this.startTime=(new Date).getTime(),this.updatePlayerEventsMetadata({type:t})),"loadstart"===t&&(this.startTime=(new Date).getTime()),"timeupdate"===t&&(this.previousTime=this.currentTime,this.currentTime=this.player.currentTime(),this.toggleForwardRewindButton()),"seeking"===t&&null===this.seekStart&&(this.seekStart=this.previousTime),"seeked"===t&&(this.updatePlayerEventsMetadata({type:t}),this.currentTime>this.seekStart?this.totalSeekedLength=this.totalSeekedLength+(this.currentTime-this.seekStart):this.seekStart>this.currentTime&&(this.totalSeekedLength=this.totalSeekedLength+(this.seekStart-this.currentTime)),this.viewerService.totalSeekedLength=this.totalSeekedLength,this.seekStart=null)},e.prototype.updatePlayerEventsMetadata=function(e){var t=e.type;this.viewerService.metaData.totalDuration=this.player.duration(),this.viewerService.metaData.playBackSpeeds.push(this.player.playbackRate()),this.viewerService.metaData.volume.push(this.player.volume());var r={};r[t+""]=this.player.currentTime(),this.viewerService.metaData.actions.push(r)},e.prototype.ngOnDestroy=function(){this.player&&this.player.dispose(),this.unlistenTargetMouseMove(),this.unlistenTargetTouchStart()},e.decorators=[{type:t.Component,args:[{selector:"video-player",template:'<video #target class="video-js" controls></video>\n<div #controlDiv>\n  <div [ngClass]="{\'player-for-back-ward-controls\': currentPlayerState === \'pause\' || showControls }">\n    <div class="player-container" *ngIf="currentPlayerState === \'pause\' || showControls">\n      <div class="back-ward hide-in-desktop" [style.visibility]="showBackwardButton ? \'visible !important\' : \'hidden\'" (click)="backward()">\n        <svg width="39px" height="49px" viewBox="0 0 39 49" version="1.1" xmlns="http://www.w3.org/2000/svg"\n          xmlns:xlink="http://www.w3.org/1999/xlink">\n          <g id="video/default-copy-2" transform="translate(-70.000000, -77.000000)" fill="#FFFFFF">\n            <path\n              d="M108.4,106.3 C108.4,116.86 99.76,125.5 89.2,125.5 C78.64,125.5 70,116.86 70,106.3 L74.8,106.3 C74.8,114.22 81.28,120.7 89.2,120.7 C97.12,120.7 103.6,114.22 103.6,106.3 C103.6,98.38 97.12,91.9 89.2,91.9 L89.2,101.5 L77.2,89.5 L89.2,77.5 L89.2,87.1 C99.76,87.1 108.4,95.74 108.4,106.3 L108.4,106.3 Z M86.4320312,113.5 L84.4,113.5 L84.4,105.667187 L81.9742187,106.419531 L81.9742187,104.767187 L86.2140625,103.248437 L86.4320312,103.248437 L86.4320312,113.5 Z M96.6484375,109.267188 C96.6484375,110.68282 96.3554717,111.765621 95.7695312,112.515625 C95.1835908,113.265629 94.3257869,113.640625 93.1960937,113.640625 C92.0804632,113.640625 91.2273467,113.27266 90.6367187,112.536719 C90.0460908,111.800778 89.7437501,110.746101 89.7296875,109.372656 L89.7296875,107.488281 C89.7296875,106.058587 90.0261689,104.973441 90.6191406,104.232812 C91.2121123,103.492184 92.0664007,103.121875 93.1820312,103.121875 C94.2976618,103.121875 95.1507783,103.488668 95.7414062,104.222266 C96.3320342,104.955863 96.6343749,106.009368 96.6484375,107.382812 L96.6484375,109.267188 Z M94.6164062,107.2 C94.6164062,106.351558 94.5003918,105.733986 94.2683594,105.347266 C94.036327,104.960545 93.6742212,104.767188 93.1820312,104.767188 C92.7039039,104.767188 92.351173,104.95117 92.1238281,105.319141 C91.8964832,105.687111 91.7757813,106.262496 91.7617187,107.045312 L91.7617187,109.534375 C91.7617187,110.368754 91.8753895,110.98867 92.1027344,111.394141 C92.3300793,111.799611 92.6945287,112.002344 93.1960937,112.002344 C93.6929712,112.002344 94.0515614,111.807814 94.271875,111.41875 C94.4921886,111.029686 94.6070312,110.434379 94.6164062,109.632812 L94.6164062,107.2 Z"\n              id="Shape-Copy"></path>\n          </g>\n        </svg>\n      </div>\n      <div class="pause-play">\n        <span class="pause" *ngIf="showPauseButton" (click)="pause()">\n          <svg width="48px" height="48px" viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg"\n            xmlns:xlink="http://www.w3.org/1999/xlink">\n            <g id="video/default-copy-2" transform="translate(-156.000000, -77.000000)" fill="#FFFFFF">\n              <path\n                d="M180.4,77.5 C167.152,77.5 156.4,88.252 156.4,101.5 C156.4,114.748 167.152,125.5 180.4,125.5 C193.648,125.5 204.4,114.748 204.4,101.5 C204.4,88.252 193.648,77.5 180.4,77.5 L180.4,77.5 Z M178,111.1 L173.2,111.1 L173.2,91.9 L178,91.9 L178,111.1 L178,111.1 Z M187.6,111.1 L182.8,111.1 L182.8,91.9 L187.6,91.9 L187.6,111.1 L187.6,111.1 Z"\n                id="Shape"></path>\n            </g>\n          </svg>\n        </span>\n        <span class="play" *ngIf="showPlayButton" (click)="play()">\n          <svg width="48px" height="48px" viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg"\n            xmlns:xlink="http://www.w3.org/1999/xlink">\n            <g id="video/default-copy" transform="translate(-296.000000, -156.000000)" fill="#FFFFFF">\n              <path\n                d="M320,156 C306.752,156 296,166.752 296,180 C296,193.248 306.752,204 320,204 C333.248,204 344,193.248 344,180 C344,166.752 333.248,156 320,156 L320,156 Z M315.2,190.8 L315.2,169.2 L329.6,180 L315.2,190.8 L315.2,190.8 Z"\n                id="Shape"></path>\n            </g>\n          </svg>\n        </span>\n      </div>\n      <div class="forward hide-in-desktop" [style.visibility]="showForwardButton ? \'visible !important\' : \'hidden\'" (click)="forward()">\n        <svg width="39px" height="49px" viewBox="0 0 39 49" version="1.1" xmlns="http://www.w3.org/2000/svg"\n          xmlns:xlink="http://www.w3.org/1999/xlink">\n          <g id="video/default-copy-2" transform="translate(-251.000000, -77.000000)" fill="#FFFFFF">\n            <path\n              d="M251.4,106.3 C251.4,116.86 260.04,125.5 270.6,125.5 C281.16,125.5 289.8,116.86 289.8,106.3 L285,106.3 C285,114.22 278.52,120.7 270.6,120.7 C262.68,120.7 256.2,114.22 256.2,106.3 C256.2,98.38 262.68,91.9 270.6,91.9 L270.6,101.5 L282.6,89.5 L270.6,77.5 L270.6,87.1 C260.04,87.1 251.4,95.74 251.4,106.3 L251.4,106.3 Z M267.832031,113.5 L265.8,113.5 L265.8,105.667187 L263.374219,106.419531 L263.374219,104.767187 L267.614062,103.248437 L267.832031,103.248437 L267.832031,113.5 Z M278.048438,109.267188 C278.048438,110.68282 277.755472,111.765621 277.169531,112.515625 C276.583591,113.265629 275.725787,113.640625 274.596094,113.640625 C273.480463,113.640625 272.627347,113.27266 272.036719,112.536719 C271.446091,111.800778 271.14375,110.746101 271.129687,109.372656 L271.129687,107.488281 C271.129687,106.058587 271.426169,104.973441 272.019141,104.232812 C272.612112,103.492184 273.466401,103.121875 274.582031,103.121875 C275.697662,103.121875 276.550778,103.488668 277.141406,104.222266 C277.732034,104.955863 278.034375,106.009368 278.048438,107.382812 L278.048438,109.267188 Z M276.016406,107.2 C276.016406,106.351558 275.900392,105.733986 275.668359,105.347266 C275.436327,104.960545 275.074221,104.767188 274.582031,104.767188 C274.103904,104.767188 273.751173,104.95117 273.523828,105.319141 C273.296483,105.687111 273.175781,106.262496 273.161719,107.045312 L273.161719,109.534375 C273.161719,110.368754 273.275389,110.98867 273.502734,111.394141 C273.730079,111.799611 274.094529,112.002344 274.596094,112.002344 C275.092971,112.002344 275.451561,111.807814 275.671875,111.41875 C275.892189,111.029686 276.007031,110.434379 276.016406,109.632812 L276.016406,107.2 Z"\n              id="Shape"></path>\n          </g>\n        </svg>\n      </div>\n    </div>\n  </div>\n\n\n</div>',encapsulation:t.ViewEncapsulation.None,styles:[".video-js{width:100%;height:100%}.video-player{width:100%}.video-js .vjs-duration{display:block}.video-js .vjs-big-play-button{display:none}.video-js .vjs-control-bar{z-index:3;font-size:12px;background:rgba(0,0,0,.75)}@media (min-width:1600px){.video-js .vjs-control-bar{font-size:16px}}.video-js .vjs-slider{background:#7b7b7b}.video-js .vjs-load-progress{background:#797979}.video-js .vjs-load-progress div{background:#a09f9f}.video-js .vjs-progress-holder,.video-js .vjs-progress-holder .vjs-load-progress,.video-js .vjs-progress-holder .vjs-load-progress div,.video-js .vjs-progress-holder .vjs-play-progress{border-radius:.2em}.vjs-menu-button-popup .vjs-menu .vjs-menu-content{background-color:rgba(0,0,0,.72)}.js-focus-visible .vjs-menu li.vjs-selected:hover,.vjs-menu li.vjs-selected,.vjs-menu li.vjs-selected:focus,.vjs-menu li.vjs-selected:hover{background-color:rgba(216,216,216,.2);color:var(--white)}.video-js .vjs-play-progress:before{top:-.3em}.vjs-playback-rate .vjs-playback-rate-value{line-height:2.75}.vjs-menu li,.vjs-playback-rate .vjs-playback-rate-value{font-size:1.1em}@media screen and (min-width:768px){.video-js .vjs-tech{pointer-events:none}}@media (hover:hover){.hide-in-desktop{visibility:hidden!important}}@media (pointer:fine){.hide-in-desktop{visibility:hidden!important}}.player-for-back-ward-controls{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;position:absolute;width:100%;height:100%;top:0;left:0;right:0;bottom:0;z-index:2}.player-for-back-ward-controls .player-container{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}.player-for-back-ward-controls .player-container .back-ward,.player-for-back-ward-controls .player-container .forward,.player-for-back-ward-controls .player-container .pause-play{width:2.5rem;height:2.5rem;padding:.5rem;-webkit-transition:.3s ease-in-out;transition:.3s ease-in-out;box-sizing:content-box;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;background:rgba(var(--rc-rgba-black),.5);border-radius:50%;-webkit-transform:scale(1);transform:scale(1)}@media (min-width:768px){.player-for-back-ward-controls .player-container .back-ward:hover,.player-for-back-ward-controls .player-container .forward:hover,.player-for-back-ward-controls .player-container .pause-play:hover{background:rgba(var(--rc-rgba-black),1);border-radius:100%;-webkit-transform:scale(1.25);transform:scale(1.25);cursor:pointer}.player-for-back-ward-controls .player-container .back-ward:hover svg g,.player-for-back-ward-controls .player-container .forward:hover svg g,.player-for-back-ward-controls .player-container .pause-play:hover svg g{fill:var(--primary-theme)}}.player-for-back-ward-controls .player-container .back-ward.touched,.player-for-back-ward-controls .player-container .forward.touched,.player-for-back-ward-controls .player-container .pause-play.touched{-webkit-animation:2s scaling;animation:2s scaling;-webkit-transform:scale(1);transform:scale(1)}@-webkit-keyframes scaling{0%,100%{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.25);transform:scale(1.25)}}@keyframes scaling{0%,100%{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.25);transform:scale(1.25)}}.player-for-back-ward-controls .player-container .back-ward.touched svg g,.player-for-back-ward-controls .player-container .forward.touched svg g,.player-for-back-ward-controls .player-container .pause-play.touched svg g{-webkit-animation:2s scalingColor;animation:2s scalingColor;fill:var(--white)}@-webkit-keyframes scalingColor{0%,100%{fill:var(--white)}50%{fill:var(--primary-theme)}}@keyframes scalingColor{0%,100%{fill:var(--white)}50%{fill:var(--primary-theme)}}.player-for-back-ward-controls .player-container .back-ward.touchout,.player-for-back-ward-controls .player-container .forward.touchout,.player-for-back-ward-controls .player-container .pause-play.touchout{-webkit-animation:2s scaling2;animation:2s scaling2;-webkit-transform:scale(1);transform:scale(1)}@-webkit-keyframes scaling2{0%,100%{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.25);transform:scale(1.25)}}@keyframes scaling2{0%,100%{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.25);transform:scale(1.25)}}.player-for-back-ward-controls .player-container .back-ward.touchout svg g,.player-for-back-ward-controls .player-container .forward.touchout svg g,.player-for-back-ward-controls .player-container .pause-play.touchout svg g{-webkit-animation:2s scalingColor2;animation:2s scalingColor2;fill:var(--white)}@-webkit-keyframes scalingColor2{0%,100%{fill:var(--white)}50%{fill:var(--primary-theme)}}@keyframes scalingColor2{0%,100%{fill:var(--white)}50%{fill:var(--primary-theme)}}.player-for-back-ward-controls .player-container .back-ward svg,.player-for-back-ward-controls .player-container .forward svg,.player-for-back-ward-controls .player-container .pause-play svg{width:100%}.player-for-back-ward-controls .player-container .pause-play{margin:0 1.5rem}.player-for-back-ward-controls .player-container .pause-play .pause,.player-for-back-ward-controls .player-container .pause-play .play{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}"]}]}],e.ctorParameters=function(){return[{type:h},{type:t.Renderer2}]},e.propDecorators={events:[{type:t.Input}],target:[{type:t.ViewChild,args:["target",{static:!0}]}],controlDiv:[{type:t.ViewChild,args:["controlDiv",{static:!0}]}]},e}();var m=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{declarations:[y,v],imports:[o.CommonModule,s.FormsModule,a.HttpClientModule,i.SunbirdPlayerSdkModule],exports:[y,i.SunbirdPlayerSdkModule]}]}],e}();e.SunbirdVideoPlayerComponent=y,e.SunbirdVideoPlayerModule=m,e.SunbirdVideoPlayerService=u,e.ɵa=d,e.ɵb=h,e.ɵc=v,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=project-sunbird-sunbird-video-player-v8.umd.min.js.map